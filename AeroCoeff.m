function [CL,CD,CM,CL_Q,CL_ADOT] = AeroCoeff(Alfa,DeltaE,Mach,adot,q,V)
%% Resistenza
global M0All M01All M02All M03All M04All M05All myAC
M0=M0All{1};
M01=M01All{1};
M02=M02All{1};
M03=M03All{1};
M04=M04All{1};
M05=M05All{1};
MachVett=[0,0.1,0.2,0.3,0.4,0.5];
Resist=zeros(length(M0.alpha),length(M0.delta),length(MachVett));
cd0=zeros(length(M0.alpha),length(M0.delta));
cd01=zeros(length(M01.alpha),length(M01.delta));
cd02=zeros(length(M02.alpha),length(M02.delta));
cd03=zeros(length(M03.alpha),length(M03.delta));
cd04=zeros(length(M04.alpha),length(M04.delta));
cd05=zeros(length(M05.alpha),length(M05.delta));
for i=1:length(M0.delta)
    cd0(:,i)=0;
    cd01(:,i)=M01.cd(:,1);
    cd02(:,i)=M02.cd(:,1);
    cd03(:,i)=M03.cd(:,1);
    cd04(:,i)=M04.cd(:,1);
    cd05(:,i)=M05.cd(:,1);
end
Resist(:,:,1)=cd0+M0.dcdi_sym;
Resist(:,:,2)=cd01+M01.dcdi_sym;
Resist(:,:,3)=cd02+M02.dcdi_sym;
Resist(:,:,4)=cd03+M03.dcdi_sym;
Resist(:,:,5)=cd04+M04.dcdi_sym;
Resist(:,:,6)=cd05+M05.dcdi_sym;
[X,Y,Z]=meshgrid(M0.delta,M0.alpha,MachVett);
[XI,YI,ZI]=meshgrid(DeltaE,Alfa,Mach);
CD=interp3(X,Y,Z,Resist,XI,YI,ZI,'spline');
%% Portanza
Port=zeros(length(M0.alpha),length(M0.delta),length(MachVett));
cl0=zeros(length(M0.alpha),length(M0.delta));
cl01=zeros(length(M01.alpha),length(M01.delta));
cl02=zeros(length(M02.alpha),length(M02.delta));
cl03=zeros(length(M03.alpha),length(M03.delta));
cl04=zeros(length(M04.alpha),length(M04.delta));
cl05=zeros(length(M05.alpha),length(M05.delta));
for i=1:length(M0.delta)
    cl0(:,i)=0;
    cl01(:,i)=M01.cl(:,1);
    cl02(:,i)=M02.cl(:,1);
    cl03(:,i)=M03.cl(:,1);
    cl04(:,i)=M04.cl(:,1);
    cl05(:,i)=M05.cl(:,1);
end
dclM0=zeros(length(M0.alpha),length(M0.delta));
dclM01=zeros(length(M0.alpha),length(M0.delta));
dclM02=zeros(length(M0.alpha),length(M0.delta));
dclM03=zeros(length(M0.alpha),length(M0.delta));
dclM04=zeros(length(M0.alpha),length(M0.delta));
dclM05=zeros(length(M0.alpha),length(M0.delta));
for j=1:length(M0.alpha)
    dclM0(j,:)=M0.dcl_sym;
    dclM01(j,:)=M01.dcl_sym;
    dclM02(j,:)=M02.dcl_sym;
    dclM03(j,:)=M03.dcl_sym;
    dclM04(j,:)=M04.dcl_sym;
    dclM05(j,:)=M05.dcl_sym;
end
Port(:,:,1)=cl0+dclM0;
Port(:,:,2)=cl01+dclM01;
Port(:,:,3)=cl02+dclM02;
Port(:,:,4)=cl03+dclM03;
Port(:,:,5)=cl04+dclM04;
Port(:,:,6)=cl05+dclM05;
[X,Y,Z]=meshgrid(M0.delta,M0.alpha,MachVett);
[XI,YI,ZI]=meshgrid(DeltaE,Alfa,Mach);
CL_STAT=interp3(X,Y,Z,Port,XI,YI,ZI,'spline');
CLA=zeros(length(M0.alpha),length(MachVett));
CLA(:,2)=M01.clad;
CLA(:,3)=M02.clad;
CLA(:,4)=M03.clad;
CLA(:,5)=M04.clad;
CLA(:,6)=M05.clad;
[X1,Y1]=meshgrid(MachVett,M0.alpha);
[XI1,YI1]=meshgrid(Mach,Alfa);
CL_ADOTD=interp2(X1,Y1,CLA,XI1,YI1,'spline');
CL_ADOT=zeros(length(Alfa),length(DeltaE),length(Mach));
for i=1:length(DeltaE)
    CL_ADOT(:,i,:)=reshape(CL_ADOTD,[length(Alfa),1,length(Mach)]);
end
CL_QDiscr=[0,M01.clq(1),M02.clq(1),M03.clq(1),M04.clq(1),M05.clq(1)];
CL_QD=interp1(MachVett,CL_QDiscr,Mach,'pchip');
CL_Q=zeros(length(Alfa),length(DeltaE),length(Mach));
for j=1:length(Mach)
    CL_Q(:,:,j)=CL_Q(:,:,j).*CL_QD(j);
end
CL=CL_STAT+(myAC.mac)./(2.*V).*CL_ADOT.*adot+(myAC.mac)./(2.*V)*CL_Q.*q;
%% Momento
Mom=zeros(length(M0.alpha),length(M0.delta),length(MachVett));
cm0=zeros(length(M0.alpha),length(M0.delta));
cm01=zeros(length(M01.alpha),length(M01.delta));
cm02=zeros(length(M02.alpha),length(M02.delta));
cm03=zeros(length(M03.alpha),length(M03.delta));
cm04=zeros(length(M04.alpha),length(M04.delta));
cm05=zeros(length(M05.alpha),length(M05.delta));
for i=1:length(M0.delta)
    cm0(:,i)=0;
    cm01(:,i)=M01.cm(:,1);
    cm02(:,i)=M02.cm(:,1);
    cm03(:,i)=M03.cm(:,1);
    cm04(:,i)=M04.cm(:,1);
    cm05(:,i)=M05.cm(:,1);
end
dcmM0=zeros(length(M0.alpha),length(M0.delta));
dcmM01=zeros(length(M0.alpha),length(M0.delta));
dcmM02=zeros(length(M0.alpha),length(M0.delta));
dcmM03=zeros(length(M0.alpha),length(M0.delta));
dcmM04=zeros(length(M0.alpha),length(M0.delta));
dcmM05=zeros(length(M0.alpha),length(M0.delta));
for j=1:length(M0.alpha)
    dcmM0(j,:)=M0.dcm_sym;
    dcmM01(j,:)=M01.dcm_sym;
    dcmM02(j,:)=M02.dcm_sym;
    dcmM03(j,:)=M03.dcm_sym;
    dcmM04(j,:)=M04.dcm_sym;
    dcmM05(j,:)=M05.dcm_sym;
end
Mom(:,:,1)=cm0+dcmM0;
Mom(:,:,2)=cm01+dcmM01;
Mom(:,:,3)=cm02+dcmM02;
Mom(:,:,4)=cm03+dcmM03;
Mom(:,:,5)=cm04+dcmM04;
Mom(:,:,6)=cm05+dcmM05;
[X,Y,Z]=meshgrid(M0.delta,M0.alpha,MachVett);
[XI,YI,ZI]=meshgrid(DeltaE,Alfa,Mach);
CM_STAT=interp3(X,Y,Z,Mom,XI,YI,ZI,'spline');
CMA=zeros(length(M0.alpha),length(MachVett));
CMA(:,2)=M01.cmad;
CMA(:,3)=M02.cmad;
CMA(:,4)=M03.cmad;
CMA(:,5)=M04.cmad;
CMA(:,6)=M05.cmad;
[X2,Y2]=meshgrid(MachVett,M0.alpha);
[XI2,YI2]=meshgrid(Mach,Alfa);
CM_ADOTD=interp2(X2,Y2,CMA,XI2,YI2,'spline');
CM_ADOT=zeros(length(Alfa),length(DeltaE),length(Mach));
for i=1:length(DeltaE)
    CM_ADOT(:,i,:)=reshape(CM_ADOTD,[length(Alfa),1,length(Mach)]);
end
CM_QDiscr=[0,M01.cmq(1),M02.cmq(1),M03.cmq(1),M04.cmq(1),M05.cmq(1)];
CM_QD=interp1(MachVett,CM_QDiscr,Mach,'pchip');
CM_Q=zeros(length(Alfa),length(DeltaE),length(Mach));
for j=1:length(Mach)
    CM_Q(:,:,j)=CM_Q(:,:,j).*CM_QD(j);
end
CM=CM_STAT+(myAC.mac)./(2.*V).*CM_ADOT.*adot+(myAC.mac)./(2.*V).*CM_Q.*q;
end